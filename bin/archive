#!/bin/sh

set -e
readonly PROJECT_ROOT="$(dirname "$0")/.."

# shellcheck source=lib/constants.sh
. "${PROJECT_ROOT}/lib/constants.sh"

# shellcheck source=lib/parse_options.sh
. "${PROJECT_ROOT}/lib/parse_options.sh"

# shellcheck source=lib/manage_archive.sh
. "${PROJECT_ROOT}/lib/manage_archive.sh"

# shellcheck source=lib/informative.sh
. "${PROJECT_ROOT}/lib/informative.sh"

# shellcheck source=lib/help.sh
. "${PROJECT_ROOT}/lib/help.sh"


# ==================
#  Main entry point
# ==================


# Sets $action, $file, $remove_files
if ! parse_options "$@"; then
  usage
  exit 1
fi

case "${action}" in
  "${ACTION_ADD}") 
    add_to_archive "${file}" "${remove_files}" 
    ;;
  "${ACTION_LIST}") 
    # shellcheck disable=SC2119
    list 
    ;;
  "${ACTION_HELP}") help ;;
  "${ACTION_VERSION}") usage ;;
  *) 
    usage
    exit 1 ;;
esac
