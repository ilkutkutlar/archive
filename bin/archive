#!/bin/sh

set -e
readonly PROJECT_ROOT="$(dirname "$0")/.."

# shellcheck source=lib/defaults.sh
. "${PROJECT_ROOT}/lib/defaults.sh"

# shellcheck source=lib/archive.sh
. "${PROJECT_ROOT}/lib/archive.sh"

# shellcheck source=lib/manage_archive.sh
. "${PROJECT_ROOT}/lib/manage_archive.sh"

# shellcheck source=lib/informative.sh
. "${PROJECT_ROOT}/lib/informative.sh"

# shellcheck source=lib/help.sh
. "${PROJECT_ROOT}/lib/help.sh"


# ==================
#  Main entry point
# ==================

# Sets $action, $file, $remove_files
parse_options "$@"

case "${action}" in
  add) 
    if [ -z "${file}" ]; then
      echo "No file argument given to '-a' option"
      exit 1
    fi

    add_to_archive "${file}" "${remove_files}" 
    ;;
  list) 
    # shellcheck disable=SC2119
    list 
    ;;
  help) help ;;
  usage) usage ;;
  *) usage ;;
esac
